<toaster-container></toaster-container>
<div class="row wrapper border-bottom white-bg page-heading">
  <div class="col-lg-9">
    <h2>Aseguradoras</h2>
    <ol class="breadcrumb">
      <li>
        <a ui-sref="inicio.inicio">Inicio</a>
      </li>
      <li>
        <a ui-sref="aseguradoras.aseguradoras">Aseguradoras</a>
      </li>
      <li class="active">
        <strong>Editar</strong>
      </li>
    </ol>
  </div>
</div>
<br>
<div class="row">
  <div class="col-xs-12">
    <div class="ibox">
      <div class="ibox-title">
        <h5>Información</h5>
      </div>
      <div class="ibox-content">
        <div class="row">
          <form method="post" name="form" ng-submit="vm.submit(form.$valid)" novalidate role="form">
            <div class="col-xs-12 col-md-6 form-group" >
              <label>Compañia<span class="color-red">*</span></label>
              <input class="form-control" name="name" ng-model="vm.form.compania" required type="phone">
            </div>

            <div class="col-xs-12 col-md-6 form-group">
              <label>Alias<span class="color-red">*</span></label>
              <input class="form-control" name="alias" ng-model="vm.form.alias" required type="phone">
            </div>

            <div class="col-xs-12 col-md-6 form-group">
              <label>RFC<span class="color-red">*</span></label>
              <input class="form-control" name="rfc" ng-model="vm.form.rfc" required type="phone">
            </div>

            <div class="col-xs-12 col-md-6 form-group">
              <label>Teléfono</label>
              <phonenumber-directive model="vm.form.phone"></phonenumber-directive>
            </div>

            <div class="col-xs-12 col-md-6 form-group" >
              <label>Website<span class="color-red">*</span></label>
              <!--<input class="form-control" name="name" ng-model="vm.form.website" required type="text">-->
              <textarea class="form-control" name="name" ng-model="vm.form.website" required cols="1" rows="1" style="resize: none;"></textarea>
            </div>


            <div class="address-container" ng-repeat="address in vm.address_list track by $index">
              <div class="col-xs-12 legend-gray btn-mt">
                <legend class="legend-title legend-flex" align="center">
                  <button type="button" class="btn btn-danger pull-left hidden-xs" name="button" ng-click="vm.deleteAddress($index)" ng-disabled="vm.address_list.length <= 1">
                    Quitar dirección
                  </button>
                  <button type="button" class="btn btn-danger pull-left visible-xs-inline-block" name="button" ng-click="vm.deleteAddress($index)" ng-disabled="vm.address_list.length <= 1">
                    <i class="glyphicon glyphicon-minus"></i>
                  </button>
                  <span>
                    Dirección #{{$index + 1}}
                  </span>
                  <button class="btn btn-success pull-right hidden-xs" ng-click="vm.addAddress()" type="button">
                    Agregar dirección
                  </button>
                  <button class="btn btn-success pull-right visible-xs-inline-block" ng-click="vm.addAddress()" type="button">
                    <i class="glyphicon glyphicon-plus"></i>
                  </button>
                </legend>
              </div>

              <div class="col-xs-12 address_components">
                <div class="col-xs-12 col-sm-6 nopadding form-group" ng-class="{ 'has-error': form.state.$invalid && !form.state.$pristine }">
                  <label>Estado<span class="color-red">*</span></label>
                  <select class="form-control" data-ng-options="estado.state for estado in vm.statesArray track by estado.url" name="state" ng-model="address.administrative_area_level_1" required>
                    <option value="" disabled="">Selecciona un estado</option>
                  </select>
                </div>

                <div class="col-xs-12 col-sm-6 nopadding form-group" ng-class="{ 'has-error': form.city.$invalid && !form.city.$pristine }">
                  <label>Municipio<span class="color-red">*</span></label>
                  <select class="form-control" data-ng-options="ciudad.city for ciudad in address.administrative_area_level_1.cities track by ciudad.url" name="city" ng-model="address.administrative_area_level_2" required>
                    <option value="" disabled="">Selecciona un municipio</option>
                  </select>
                  <!-- <pre>{{vm.address_list[0].administrative_area_level_2 | json}}</pre> -->
                </div>

                <div class="col-xs-12 col-md-8 nopadding form-group">
                  <label>Calle</label>
                  <input type="text" class=" form-control" ng-model="address.route" id="id_address_route" name="address_route" data-geo="route" />
                </div>

                <div class="col-xs-12 col-sm-6 col-md-2 nopadding form-group">
                  <label>Num. Ext.</label>
                  <input type="text" class=" form-control" ng-model="address.street_number" id="id_address_street_number" name="address_street_number" data-geo="street_number" />
                </div>

                <div class="col-xs-12 col-sm-6 col-md-2 nopadding form-group">
                  <label>Num. Int.</label>
                  <input type="text" class=" form-control" ng-model="address.street_number_int" id="id_address_street_number_int" name="address_street_number_int" />
                </div>

                <div class="col-xs-12 col-sm-6 nopadding form-group">
                  <label>Colonia</label>
                  <input type="text" class=" form-control" ng-model="address.sublocality" id="id_address_sublocality" name="address_sublocality" data-geo="sublocality" />
                </div>

                <div class="col-xs-12 col-sm-6 nopadding form-group">
                  <label>Código Postal</label>
                  <input type="tel" name="zip" ng-model="address.postal_code" minlength="5" maxlength="5" class="form-control" ng-keypress=filterValue($event) />
                </div>

                <div class="col-xs-12 nopadding form-group">
                  <label>Referencias</label>
                  <input type="text" class=" form-control" ng-model="address.details" id="id_address_details" name="address_details" />
                </div>

                <input type="hidden" class=" form-control" ng-model="address.administrative_area_level_1_short" id="id_address_administrative_area_level_1_short" name="address_state_code" data-geo="administrative_area_level_1_short" />

                <input type="hidden" class=" form-control" ng-model="address.country" id="id_address_country" name="address_country" data-geo="country" value="México" />

                <input type="hidden" class=" form-control" ng-model="address.composed" id="id_address_composed" name="address_composed" />

                <input type="hidden" class=" form-control" ng-model="address.country_code" id="id_address_country_code" name="address_country_code" data-geo="country_short" value="MX" />

                <input type="hidden" class=" form-control" ng-model="address.locality" id="id_address_locality" name="address_locality" data-geo="locality" />

                <input type="hidden" class=" form-control" ng-model="address.latitude" id="id_address_latitude" name="address_latitude" data-geo="lat" />

                <input type="hidden" class=" form-control" ng-model="address.longitude" id="id_address_longitude" name="address_longitude" data-geo="lng" />

                <input type="hidden" class=" form-control" ng-model="address.formatted" id="id_address_formatted" name="address_formatted" data-geo="formatted_address" />
              </div>
            </div>

            <div class="col-xs-12 form-group btn-mt">
              <label>Observaciones</label>
              <textarea class="form-control" type="text" ng-model="vm.form.description"></textarea>
            </div>

            <div>
              <div class="col-xs-12">
                <legend class="legend-title" align="center">
                  Información de contacto
                </legend>
              </div>

              <div class="col-xs-12">
                <div class="row" ng-if="vm.form.contact_provider.length == 0">
                  <div class="col-xs-12 legend-gray">
                    <legend class="legend-title legend-flex" align="center">
                      <button type="button" class="btn btn-danger pull-left hidden-xs" name="button" ng-disabled="vm.form.contact_provider == 0">
                        Quitar contacto
                      </button>
                      <button type="button" class="btn btn-danger pull-left visible-xs-inline-block" name="button" ng-disabled="vm.form.contact_provider.length == 0">
                        <i class="glyphicon glyphicon-minus"></i>
                      </button>
                      <span>
                        Contactos
                      </span>
                      <button class="btn btn-success pull-right hidden-xs" ng-click="vm.addContact()" type="button">
                        Agregar contacto
                      </button>
                      <button class="btn btn-success pull-right visible-xs-inline-block" ng-click="vm.addContact()" type="button">
                        <i class="glyphicon glyphicon-plus"></i>
                      </button>
                    </legend>
                  </div>
                </div>

                <div class="row address-container" ng-repeat="contact in vm.form.contact_provider track by $index">
                  <div class="col-xs-12 legend-gray">
                    <legend class="legend-title legend-flex" align="center">
                      <button type="button" class="btn btn-danger pull-left hidden-xs" name="button" ng-click="vm.deleteContacts(contact.url, $index)">
                        Quitar contacto
                      </button>
                      <button type="button" class="btn btn-danger pull-left visible-xs-inline-block" name="button" ng-click="vm.deleteContacts(contact.url, $index)">
                        <i class="glyphicon glyphicon-minus"></i>
                      </button>
                      <span>
                        Contacto #{{$index + 1}}
                      </span>
                      <button class="btn btn-success pull-right hidden-xs" ng-click="vm.addContact()" type="button">
                        Agregar contacto
                      </button>
                      <button class="btn btn-success pull-right visible-xs-inline-block" ng-click="vm.addContact()" type="button">
                        <i class="glyphicon glyphicon-plus"></i>
                      </button>
                    </legend>
                  </div>

                  <div class="col-xs-12 address_components">
                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Nombre</label>
                      <input class="form-control" type="text" ng-model="contact.name">
                    </div>

                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Correo electrónico</label>
                      <input class="form-control" type="email" ng-model="contact.email">
                    </div>

                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Teléfono</label>
                      <phonenumber-directive placeholder="myPrompt" model="contact.phone_number"></phonenumber-directive>
                    </div>

                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Departamento</label>
                      <input class="form-control" type="text" ng-model="contact.departament">
                    </div>

                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Ramo</label>
                      <select class="form-control" ng-model="contact.conramo" data-ng-options="ramo.ramo_name for ramo in vm.ramos track by ramo.url" ng-change="vm.changeRamo(contact, contact.conramo)">
                        <option value="">Todos los ramos</option>
                      </select>
                    </div>

                    <div class="col-xs-12 col-sm-4 form-group">
                      <label>Subramo</label>
                      <select class="form-control" ng-model="contact.consubramo" data-ng-options="subramo.subramo_name for subramo in vm.subramos track by subramo.url" ng-change = "vm.changeSubramo(contact, contact.consubramo)">
                        <option value="">Todos los subramos</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="btn-mt">
                  <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 form-group pull-right">
                    <button class="col-xs-12 btn btn-primary" ng-disabled="form.$invalid" type="submit" ng-click="vm.save()" ng-if="vm.user.permiso.editar" type="submit">Guardar Cambios</button>
                  </div>
                  <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 form-group pull-right">
                    <button id="cancelButtonMoral" class="col-xs-12 btn btn-danger" ng-click="vm.cancel()" type="button">Cancelar</button>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

