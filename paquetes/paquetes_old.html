<toaster-container></toaster-container>
<div class="row wrapper border-bottom white-bg page-heading">
  <div class="col-lg-9">
    <h2>Paquetes</h2> 
    <ol class="breadcrumb margin-top-15">
      <li>
        <a ui-sref="inicio.inicio">Inicio</a>
      </li>
      <li class="active">
        <strong>Paquetes</strong>
      </li>
    </ol>
  </div>
</div>

<div class="wrapper wrapper-content animated fadeIn ng-scope">
  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins collapsed">
        <div class="ibox-title">
          <h5>Agregar nuevos paquetes</h5>
          <div ibox-tools></div>
        </div>
        <div class="ibox-content">
          <div class="alert alert-danger" ng-show="vm.error">{{vm.error}}</div>
          <form class="form-horizontal" method="post" name="form" ng-submit="vm.submit(form.$valid)" novalidate role="form">
            <div class="form-group">
              <label class="col-sm-2 control-label">Nombre del paquete*</label>
              <div class="col-sm-10">
                <input class="form-control" name="packageName" ng-model="vm.form.package_name" required type="text">
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Proveedor*</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-model="vm.form.provider"
                    data-ng-options="provider.compania for provider in vm.providers track by provider.url"
                    ng-change="vm.changeProvider(vm.form.provider)"
                    required>
                    <option value="">Selecciona un proveedor</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Ramo*</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-model="vm.form.ramo"
                    data-ng-options="ramo.ramo_name for ramo in vm.ramos track by ramo.url"
                    ng-change="vm.changeRamo(vm.form.ramo)"
                    required>
                    <option value="">Selecciona un ramo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Subramos*</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-model="vm.form.subramo"
                    data-ng-options="subramo.subramo_name for subramo in vm.subramos track by subramo.url" required>
                    <option value="">Selecciona un subramo</option>
                </select>
              </div>
            </div>
            <div class="hr-line-dashed"></div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Observaciones</label>
              <div class="col-sm-10">
                <textarea class="form-control" name="description" ng-model="vm.form.description" type="text"></textarea>
              </div>
            </div>
            <div class="hr-line-dashed"></div>
            <div class="row">
              <div class="form-group col-sm-12">
                <button class="btn btn-white pull-right" type="button">Cancelar</button>
                <button class="btn btn-success pull-right margin-right-10" ng-disabled="!vm.form.package_name" type="submit">Crear paquete</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins collapsed">
        <div class="ibox-title">
          <h5>Agregar nueva cobertura</h5>
          <div ibox-tools></div>
        </div>
        <div class="ibox-content">
          <div class="alert alert-danger" ng-show="vm.error">{{vm.error}}</div>
          <form class="form-horizontal" method="post" name="form" ng-submit="vm.submit(form.$valid)" novalidate role="form">
            <div class="form-group" ng-class="{ 'has-error': form.name.$invalid && !form.name.$pristine  }">
              <label class="col-sm-2 control-label">Nombre de la cobertura*</label>
              <div class="col-sm-10">
                <input class="form-control" name="coverage" ng-model="vm.form.coverage_name" required type="text">
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Proveedor</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="prov as prov.compania for prov in vm.providers" ng-model="vm.form.coverage_provider" ng-change="vm.changeCoverageProvider(vm.form.coverage_provider)">
                  <option value="">Selecciona un proveedor</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Ramo</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="ramo.ramo_name for ramo in vm.coverage_ramos track by ramo.url" ng-model="vm.form.coverage_ramo" ng-change="vm.changeCoverageRamo(vm.form.coverage_ramo)">
                  <option value="">Selecciona un ramo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Subramo</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="subramo.subramo_name for subramo in vm.coverage_subramos track by subramo.url" ng-model="vm.form.coverage_subramo" ng-change="vm.changeCoverageSubramo(vm.form.coverage_subramo)">
                  <option value="">Selecciona un subramo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Paquete</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="paquete.package_name for paquete in vm.coverage_paquetes track by paquete.url" ng-model="vm.form.coverage_paquete">
                   <option value="">Selecciona un paquete</option>
                </select>
              </div>
            </div>

              <div class="hr-line-dashed"></div>
              <div class="form-group">
                <div class="col-sm-4 col-sm-offset-2">
                  <!-- <button class="btn btn-white" type="button">Cancelar</button> -->
                  <button class="btn btn-primary" ng-disabled="form.$invalid" type="button" ng-click="vm.createCoverage()">Crear cobertura</button>
                </div>
              </div>

          </form>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins collapsed">
        <div class="ibox-title">
          <h5>Personalizar paquetes</h5>
          <div ibox-tools></div>
        </div>
        <div class="ibox-content">
          <div class="row">
            <div class="alert alert-danger" ng-show="vm.error">{{vm.error}}</div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Proveedor</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="prov as prov.compania for prov in vm.providers" ng-model="vm.form.package_provider" ng-change="vm.changePackageProvider(vm.form.package_provider)">
                  <option value="">Selecciona un proveedor</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Ramo</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="ramo.ramo_name for ramo in vm.package_ramos track by ramo.url" ng-model="vm.form.package_ramo" ng-change="vm.changePackageRamo(vm.form.package_ramo)">
                  <option value="">Selecciona un ramo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Subramo</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="subramo.subramo_name for subramo in vm.package_subramos track by subramo.url" ng-model="vm.form.package_subramo" ng-change="vm.changePackageSubramo(vm.form.package_subramo)">
                  <option value="">Selecciona un subramo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">Paquete</label>
              <div class="col-sm-10">
                <select class="form-control m-b" ng-options="paquete.package_name for paquete in vm.package_paquetes track by paquete.url" ng-model="vm.form.package_paquete" ng-change="vm.changePackagePackage(vm.form.package_paquete)">
                   <option value="">Selecciona un paquete</option>
                </select>
              </div>
            </div>

            <!-- table -->
            <div class="form-group">
              <table class="table footable table-stripped" data-filter="#filter" data-page-size="25" ng-if="vm.form.package_paquete" >
                <thead>
                  <tr class="col-xs-12" >
                    <th class="text-align-center footable-visible footable-sortable footable-first-column" data-breakpoints="xs">Cobertura</th>
                    <th class="footable-visible footable-sortable" data-hide="phone" ></th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="col-xs-12 col-md-6" ng-repeat="coverage in vm.package_covs" >
                    <td class="col-xs-11">
                      <p class="col-xs-12" ng-bind="coverage.coverage_name"></p>
                    </td>
                    
                    <td class="col-xs-6">
                      <button ng-if="coverage.default" class="col-xs-12 btn btn-info pull-right" name="button" ng-click="vm.makeDefaultCoverage(coverage)" type="button">Desactivar</button>
                      <button ng-if="!coverage.default" class="col-xs-12 btn btn-warning pull-right" name="button" ng-click="vm.makeDefaultCoverage(coverage)" type="button">Activar</button>
                    </td>
                  </tr>
                </tbody>
                <tfoot class="hide-if-no-paging">
                  <tr>
                    <td colspan="6" align="center">
                      <ul class="pagination"></ul>
                    </td>
                  </tr>
                </tfoot>
              </table>
            </div>
            <!-- /table -->
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins">
        <div class="ibox-title">
          <h5>Informaci√≥n de paquetes</h5>
          <div ibox-tools></div>
        </div>
        <div class="ibox-content">
          <div class="table-responsive">
            <table class="table footable table-stripped" data-filter="#filter" data-page-size="25">
              <thead>
                <tr>
                  <th class="footable-visible footable-sortable footable-first-column">
                  Paquetes
                    <span class="footable-sort-indicator"></span>
                  </th>
                  <th class="footable-sortable" data-hide="phone" >
                  Aseguradora
                    <span class="footable-sort-indicator"></span>
                  </th>
                  <th data-hide="phone" class="footable-sortable" style="display: none;">
                  Ramos
                    <span class="footable-sort-indicator"></span>
                  </th>
                  <th data-hide="phone" class="footable-sortable" style="display: none;">
                  Subramos
                    <span class="footable-sort-indicator"></span>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="pack in vm.totalPackages track by $index" ng-click="vm.goToPackageEditor(pack)" foo-repeat-done>
                  <td>{{pack.package_name}}</td>
                  <td>{{pack.provider}}</td>
                  <td>{{pack.ramo}}</td>
                  <td>{{pack.subramo}}</td>
                </tr>
                  <!-- <td><a ui-sref="contratantes.edit({type: 'morales', contratanteId: '3'})" type="button" class="btn btn-w-m btn-info" name="button">Editar</button></td> -->
              </tbody>
              <tfoot class="hide-if-no-paging">
                  <tr>
                    <td colspan="6" align="center">
                      <ul class="pagination"></ul>
                    </td>
                  </tr>
                </tfoot>
            </table>
          </div>
        </div>

        <!--<div class="ibox-content">
          <div class="table-responsive">
            <table datatable="ng" class="table table-striped table-bordered table-hover">
              <thead>
                <tr>
                  <th>Paquetes</th>
                  <th>Aseguradora</th>
                  <th>Ramos</th>
                  <th>Subramos</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="pack in vm.totalPackages track by $index" ng-click="vm.goToPackageEditor(pack)">
                  <td>{{pack.package_name}}</td>
                  <td>{{pack.provider}}</td>
                  <td>{{pack.ramo}}</td>
                  <td>{{pack.subramo}}</td>
                </tr>
                  <td><a ui-sref="contratantes.edit({type: 'morales', contratanteId: '3'})" type="button" class="btn btn-w-m btn-info" name="button">Editar</button></td> 
              </tbody>
            </table>
          </div>
        </div>-->
      </div>
    </div>
  </div>
</div>
